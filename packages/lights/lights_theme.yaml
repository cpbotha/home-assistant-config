# sensor:
#   - platform: template
#     sensors:
#       # Template sensor to display input value only
#       lights_theme:
#         friendly_name: "Lights theme"
#         icon_template: "mdi:home-lightbulb-outline"
#         value_template: >-
#           {% if states('number.depth_of_discharge_on_grid')|int > 0 %}
#             {{ (states('number.depth_of_discharge_on_grid')|int) }}
#           {% else %}
#             {{ 0 }}
#           {% endif %}



    # condition:
    #   - condition: state  # 'night' condition: from sunset until sunrise 
    #     entity_id: sun.sun
    #     state: 'below_horizon'


          # brightness: >-
          #   {%- if(is_state('alarm_control_panel.home_alarm','armed_home')) -%}
          #   30
          #   {%- else -%}
          #   60
          #   {%- endif -%}


          # brightness: >-
          #   {% set time = states('sensor.time') %}
          #   {%- if(is_state('input_boolean.kitchenwork','on')) -%}
          #   185
          #   {%- elif(is_state('alarm_control_panel.home_alarm','armed_home')) -%}
          #   30
          #   {% elif '18:00' <= time <= '20:25' %}
          #   175
          #   {% elif '05:30' <= time <= '07:30' %}
          #   175
          #   {%- elif(is_state('media_player.plex_plex_for_android_tv_bravia_vu1','playing')) -%}
          #   30
          #   {%- else -%}
          #   175
          #   {%- endif -%}

          # brightness_pct: >-
          #   {% set hours = [[0,1],[500,25],[600,45],[630,55],[700,60],[730,65],
          #                 [800,70],[900,75],[1630,75],[1700,70],[1730,65],
          #                 [1800,55],[1830,50],[1900,40],[1930,35],[2000,30],
          #                 [2010,25],[2020,20],[2030,17],[2100,15],[2300,1]] %}
          #   {% set t = states('sensor.time').replace(':','')|int %}
          #   {% set ns = namespace(level = 0) %}
          #   {% for h in hours if t >= h[0] %}
          #     {% set ns.level = h[1] %}
          #   {% endfor %}
          #   {%- if(is_state('alarm_control_panel.home_alarm','armed_home')) -%}
          #   15
          #   {%- else -%}
          #   {{ ns.level }}
          #   {%- endif -%}

# automation:
#   ### Turn off all lights in the morning
#   - alias: Turn off all lights in the morning
#     description: Turn off all lights in the morning
#     trigger:
#     - platform: sun
#       event: sunrise
#       offset: "+00:20:00"
#     action:
#     - service: light.turn_off
#       data_template:
#         entity_id: >
#           {%- set data = namespace(lights_todo=[]) -%}
#           {%- set domains = ['light'] -%}
#           {%- for domain in domains -%}
#             {%- for item in states[domain]  -%}
#               {%- if item.entity_id not in ['light.main_bathroom'] and item.attributes.icon != 'mdi:lightbulb-group' %}
#                 {%- set data.lights_todo = data.lights_todo + [item.entity_id] %}
#               {%- endif -%}
#             {%- endfor -%}
#           {%- endfor -%}
#           {{ data.lights_todo | join(",") }}